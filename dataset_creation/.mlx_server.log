/Users/tristan/AI/AI-Training/Datasets/CyberLLMInstruct/dataset_creation/mlx_parallm/advanced_server.py:289: DeprecationWarning: 
        on_event is deprecated, use lifespan event handlers instead.

        Read more about it in the
        [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
        
  @app.on_event("startup")
/Users/tristan/AI/AI-Training/Datasets/CyberLLMInstruct/dataset_creation/mlx_parallm/advanced_server.py:354: DeprecationWarning: 
        on_event is deprecated, use lifespan event handlers instead.

        Read more about it in the
        [FastAPI docs for Lifespan Events](https://fastapi.tiangolo.com/advanced/events/).
        
  @app.on_event("shutdown")
2025-07-18 13:48:38,526 - INFO - Started server process [19579]
2025-07-18 13:48:38,526 - INFO - Waiting for application startup.
2025-07-18 13:48:38,526 - INFO - Initializing combined engine with model: mlx-community/c4ai-command-r-v01-4bit and draft: mlx-community/Phi-3-mini-4k-instruct-4bit
2025-07-18 13:48:38,526 - INFO - Loading target model: mlx-community/c4ai-command-r-v01-4bit
2025-07-18 13:48:38,526 - INFO - Enabling KV cache with 8-bit quantization
2025-07-18 13:48:38,527 - ERROR - Traceback (most recent call last):
  File "/Users/tristan/AI/AI-Training/Datasets/CyberLLMInstruct/.venv/lib/python3.13/site-packages/starlette/routing.py", line 694, in lifespan
    async with self.lifespan_context(app) as maybe_state:
               ~~~~~~~~~~~~~~~~~~~~~^^^^^
  File "/Users/tristan/AI/AI-Training/Datasets/CyberLLMInstruct/.venv/lib/python3.13/site-packages/starlette/routing.py", line 571, in __aenter__
    await self._router.startup()
  File "/Users/tristan/AI/AI-Training/Datasets/CyberLLMInstruct/.venv/lib/python3.13/site-packages/starlette/routing.py", line 671, in startup
    await handler()
  File "/Users/tristan/AI/AI-Training/Datasets/CyberLLMInstruct/dataset_creation/mlx_parallm/advanced_server.py", line 323, in startup_event
    combined_engine = AsyncCombinedEngine(combined_config)
  File "/Users/tristan/AI/AI-Training/Datasets/CyberLLMInstruct/dataset_creation/mlx_parallm/combined_inference.py", line 554, in __init__
    self.engine = CombinedInferenceEngine(config)
                  ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/tristan/AI/AI-Training/Datasets/CyberLLMInstruct/dataset_creation/mlx_parallm/combined_inference.py", line 103, in __init__
    self.target_model, self.tokenizer = load(config.target_model_path, **load_kwargs)
                                        ~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: load() got an unexpected keyword argument 'kv_bits'

2025-07-18 13:48:38,527 - ERROR - Application startup failed. Exiting.
